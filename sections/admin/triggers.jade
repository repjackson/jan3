template(name='triggers')
    .ui.stackable.centered.padded.grid
        .centered.row
            .four.wide.column
                h2.ui.center.aligned.header 
                    i.bolt.icon(title='Triggers take action when a ticket is created or updated. For example, use a trigger to send email notifications when an agent adds a comment to a ticket. The order of your triggers is important because triggers can act on changes made by other triggers')
                    |Triggers
                +add_button type='trigger'
                +tag_facet
            .twelve.wide.column
                // h4 Triggers take action when a ticket is created or updated. For example, use a trigger to send email notifications when an agent adds a comment to a ticket. The order of your triggers is important because triggers can act on changes made by other triggers.Learn more
                .ui.cards
                    each triggers
                        +trigger_card
                        
                        
template(name='trigger_item')
    .ui.item
        .content
            a.grey.header(href="/view/#{_id}") 
                |#{title}
            .description
                .ui.grid
                    .twelve.wide.column
                        |!{html}
                    .four.wide.column
                        .meta #{when}
                        .meta #{formal_when}
                        .meta by #{author.username}
                        if comment_count
                            a.meta(href="/view/#{_id}")
                                i.comments.icon
                                |#{comment_count} comments
                        +view_button
        

                
template(name='trigger_card')
    .ui.card
        .content
            .header #{title}
        .content    
            |!{html}
            .right.floated 
                // |#{when}
                +author_info
        .content
            each tags
                .ui.label #{this}
        .content
            // +call_method name='tagify_timestamp'
            // if date_array
            //     each date_array
            //         .ui.label #{this}
            +small_comment_count
            +edit_button
            +view_button




template(name='trigger_table')
    table.ui.celled.selectable.table
        tbody
            each triggers
                +trigger_row
                
                
template(name='trigger_row')                
    tr
        // td #{_id}
        td 
            a(href="/view/#{_id}") #{text}
            |#{title}
            // if editing_this_trigger
            //     .ui.fluid.input
            //         input.trigger_text(type='text' value=text placeholder='trigger Text')
        td #{when}
        // td #{due_date_when}
        td 
            +edit_button
            +view_full_button
        // td
            // if editing_this_trigger
            //     .save_trigger.ui.icon.button
            //         i.checkmark.icon
            // else
            //     .edit_trigger.ui.icon.button
            //         i.edit.icon
            
            
template(name='trigger_view')
    .ui.padded.stackable.centered.grid
        .centered.row
            .three.wide.column
                +link_button link='/triggers' icon='bolt' label='triggers'
            .ten.wide.column
                h1.ui.center.aligned.grey.header View #{title} Trigger
            .three.wide.column
                +edit_button
        .row
            .three.wide.column
                .ui.header tags
                each tags
                    .ui.label #{this}
            .thirteen.wide.column
                .ui.heade #{title}
                |!{html}
                +comments
            
        
template(name='trigger_edit')
    .ui.padded.stackable.centered.grid
        .centered.row
            .three.wide.column
                +save_button
            .ten.wide.column
                h1.ui.center.aligned.grey.header Edit #{title} Trigger
            .three.wide.column
                #delete.ui.icon.button
                    i.trash.icon
        .centered.row
            .twelve.wide.column
                +edit_text_field key='title' label='Title'
                +condition_selector
                +action_selector
            .four.wide.column
                +edit_array_field key='tags'
        
            
            
template(name='condition_selector')
    .ui.header Condition Selector
    .ui.sub.header Conditions that must be met for the trigger to run

    
template(name='action_selector')
    .ui.header Action Selector
    .ui.sub.header Actions that will occur if global conditions are satisfied

