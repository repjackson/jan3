template(name='tasks')
    .ui.stackable.padded.grid
        .middle.aligned.row 
            .three.wide.center.aligned.column
            .ten.wide.column
                h1.ui.center.aligned.header 
                    +icon name='realtime-protection'
                    | Tasks
            .three.wide.center.aligned.column
                +add_button type='task'
        .row 
            .three.wide.column
                .ui.header Total
                    +view_stat doc_type='task' stat_type='total' 
                .ui.header Complete #{complete_task_count}
                .ui.header Incomplete #{incomplete_task_count}
                .ui.indicating.progress
                    .bar
                    .label Completion
            .ten.wide.column
                .ui.divided.cards
                    each tasks
                        +task_card
            .three.wide.column
                +feed doc_type='task' icon='overview-pages-4' title='Task Events'

template(name='task_card')
    .ui.card
        .content
            a(href="/view/#{_id}")
                if complete
                    i.green.checkmark.icon
                |#{title} 
        .content
            h4.ui.header Assigned To
        .content
            each tags
                .ui.small.basic.label #{this}
        .content
            |Due Date: #{due_date}
        .content
            |by 
            +author_info
            div
            |#{when} {{ reg_format timestamp }}
        .extra.content
            +vote_button
            +mark_doc_complete_button
            +edit_button
            +view_button
        
        
        
template(name='task_edit')
    .ui.padded.stackable.centered.grid
        .centered.row
            .three.wide.center.aligned.column
                #delete.ui.icon.button
                    i.trash.icon
            .ten.wide.column
                h1.ui.center.aligned.grey.header Edit Task
            .three.wide.center.aligned.column
                +save_button
        .eight.wide.column
            .ui.form
                +edit_text_field key='title' label='title'
                +edit_textarea label='Details' key='incident_details' icon='view-details'
                +edit_array_field label='Tags' key='tags'
        
template(name='task_view')
    .ui.padded.stackable.centered.grid
        .centered.middle.aligned.row
            .three.wide.center.aligned.column
                a.ui.button(href="/tasks")
                    i.up.chevron.icon
                    | Tasks
            .ten.wide.column
                h1.ui.center.aligned.grey.header View Task
            .three.wide.center.aligned.column
                +edit_button
        .row
            .four.wide.column
                +mark_doc_complete_button
                +notify_button
                +multiple_user_select key='assigned_to' label='Assigned To' icon='user-shield'
            .eight.wide.column
                .ui.header Title: #{title}
                +full_doc_history
            .four.wide.column
                +edit_date_field label='Due Date' key='due_date'

template(name='mark_doc_complete_button')
    .mark_complete.ui.icon.basic.button(class=complete_button_class) 
        if complete
            +mini_sprite name='checkmark' classes='ui mini inline image'
            // | Completed
        else
            +mini_sprite name='unchecked-checkbox' classes='ui mini inline image'
            // | Complete
