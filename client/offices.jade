template(name='offices')
    .ui.stackable.centered.padded.grid
        .middle.aligned.row
            .three.wide.column
                +link_button link='/admin' icon='user-shield' label='Admin'
            .ten.wide.column
                h1.ui.center.aligned.header
                    +icon name='building'
                    |Offices
            .three.wide.column
                // if is_dev
                +call_method name='sync_offices'
        .row
            .sixteen.wide.column
                +reactiveTable settings=settings class="ui celled striped sortable table"


                    
template(name='office_view')
    .ui.padded.stackable.grid
        .centered.middle.aligned.row
            .three.wide.column
                unless is_customer
                    +link_button link='/offices' icon='building' label='Offices'
            .ten.wide.column
                h1.ui.center.aligned.grey.header #{ev.MASTER_LICENSEE} Office
            .three.wide.right.aligned.column
                // +edit_button
        .row
            .sixteen.wide.column
                .ui.secondary.segment
                    .ui.list
                        .item ID
                            strong #{ev.ID}
                        .item Office Name
                            strong #{ev.MASTER_LICENSEE}
                        .item Office Manager
                            strong #{ev.MASTER_OFFICE_MANAGER}
                        .item Office Owner
                            strong #{ev.MASTER_OFFICE_OWNER}
                        .item Last Updated
                            strong #{ev.TIMESTAMP}
                        .item Phone
                            strong #{ev.TELEPHONE}
                        .item Address 
                            strong #{ev.ADDR_STREET} #{ev.ADDR_STREET_2} #{ev.ADDR_CITY} #{ev.ADDR_STATE} #{ev.ADDR_POSTAL_CODE} #{ev.MASTER_COUNTRY}
                unless is_customer 
                    +office_admin_section


template(name='office_admin_section')
    .ui.top.attached.tabular.five.item.stackable.menu
        a.active.item(data-tab='office_settings') 
            +icon name='administrative-tools'
            | &nbsp; Settings
        a.item(data-tab='incidents') 
            +icon name='error'
            | &nbsp; Incidents
        a.item(data-tab='employees') 
            +icon name='groups'
            | &nbsp; Employees
        a.item(data-tab='franchisees') 
            +icon name='conference'
            | &nbsp; Franchisees
        a.item(data-tab='customers') 
            +icon name='customer-support'
            | &nbsp; Customers
    .ui.bottom.attached.active.tab.segment(data-tab='office_settings')
        h2.ui.dividing.header 
            +icon name='sms'
            | Customer Message
        // .ui.sub.header Shown on customer dashboard
        +edit_text_field key='customer_message' label='Customer Dashboard Message'
        // p #{customer_message}
        // h2.ui.dividing.header 
        //     +icon name='checked-user-male'
        //     |Office Roles
        // .ui.two.column.stackable.grid
        //     .column
        //         +single_user_select key='office_owner' label='Office Owner'
        //     .column
        //         +single_user_select key='operations_manager' label='Operations Manager'
        h2.ui.dividing.header 
            +icon name='administrative-tools'
            |SLA Settings
        h3.ui.dividing.header Initial
        h3.ui.dividing.header Escalation 1
        .ui.two.column.divided.padded.grid
            .row
                +edit_number_field key='escalation_one_hours' label='Escalation Hours' field_class='inline' min=0 max=24
            .row
                .column
                    h4.ui.header Primary Contact
                    .ui.two.column.stackable.grid
                        .row
                            .column
                                .ui.form
                                    .grouped.fields
                                        // label Primary Contact
                                        +radio_item key='escalation_one_primary_contact' label='Office Owner' value='office_owner'
                                        +radio_item key='escalation_one_primary_contact' label='Operations Manager' value='operations_manager'
                                +toggle_boolean_checkbox key='escalation_one_primary_contact_franchisee' label='Franchisee'
                            .column
                                +view_sla_contact key='escalation_one_primary_contact'
                                .ui.hidden.divider
                                if escalation_one_primary_contact_franchisee
                                    p Franchisee will be contacted.
                                else
                                    p Franchisee will not be contacted.
                .column
                    h4.ui.header Secondary Contact
                    .ui.two.column.stackable.grid
                        .row
                            .column
                                .ui.form
                                    .grouped.fields
                                        // label Primary Contact
                                        +radio_item key='escalation_one_scondary_contact' label='Office Owner' value='office_owner'
                                        +radio_item key='escalation_one_scondary_contact' label='Operations Manager' value='operations_manager'
                                +toggle_boolean_checkbox key='escalation_one_scondary_contact_franchisee' label='Franchisee'
                            .column
                                +view_sla_contact key='escalation_one_scondary_contact'
                                .ui.hidden.divider
                                if escalation_one_scondary_contact_franchisee
                                    p Franchisee will be contacted.
                                else
                                    p Franchisee will not be contacted.
        h3.ui.dividing.header Escalation 2
        .ui.two.column.divided.padded.grid
            .row
                +edit_number_field key='escalation_two_hours' label='Escalation Hours' field_class='inline' min=0 max=24
            .row
                .column
                    h4.ui.header Primary Contact
                    .ui.two.column.stackable.grid
                        .row
                            .column
                                .ui.form
                                    .grouped.fields
                                        // label Primary Contact
                                        +radio_item key='escalation_two_primary_contact' label='Office Owner' value='office_owner'
                                        +radio_item key='escalation_two_primary_contact' label='Operations Manager' value='operations_manager'
                                +toggle_boolean_checkbox key='escalation_two_primary_contact_franchisee' label='Franchisee'
                            .column
                                +view_sla_contact key='escalation_two_primary_contact'
                                .ui.hidden.divider
                                if escalation_two_primary_contact_franchisee
                                    p Franchisee will be contacted.
                                else
                                    p Franchisee will not be contacted.
                .column
                    h4.ui.header Secondary Contact
                    .ui.two.column.stackable.grid
                        .row
                            .column
                                .ui.form
                                    .grouped.fields
                                        // label Primary Contact
                                        +radio_item key='escalation_two_scondary_contact' label='Office Owner' value='office_owner'
                                        +radio_item key='escalation_two_scondary_contact' label='Operations Manager' value='operations_manager'
                                +toggle_boolean_checkbox key='escalation_two_scondary_contact_franchisee' label='Franchisee'
                            .column
                                +view_sla_contact key='escalation_two_scondary_contact'
                                .ui.hidden.divider
                                if escalation_two_scondary_contact_franchisee
                                    p Franchisee will be contacted.
                                else
                                    p Franchisee will not be contacted.
        h3.ui.dividing.header Escalation 3
        .ui.two.column.divided.padded.grid
            .row
                +edit_number_field key='escalation_three_hours' label='Escalation Hours' field_class='inline' min=0 max=24
            .row
                .column
                    h4.ui.header Primary Contact
                    .ui.two.column.stackable.grid
                        .row
                            .column
                                .ui.form
                                    .grouped.fields
                                        // label Primary Contact
                                        +radio_item key='escalation_three_primary_contact' label='Office Owner' value='office_owner'
                                        +radio_item key='escalation_three_primary_contact' label='Operations Manager' value='operations_manager'
                                +toggle_boolean_checkbox key='escalation_three_primary_contact_franchisee' label='Franchisee'
                            .column
                                +view_sla_contact key='escalation_three_primary_contact'
                                .ui.hidden.divider
                                if escalation_three_primary_contact_franchisee
                                    p Franchisee will be contacted.
                                else
                                    p Franchisee will not be contacted.
                .column
                    h4.ui.header Secondary Contact
                    .ui.two.column.stackable.grid
                        .row
                            .column
                                .ui.form
                                    .grouped.fields
                                        // label Primary Contact
                                        +radio_item key='escalation_three_scondary_contact' label='Office Owner' value='office_owner'
                                        +radio_item key='escalation_three_scondary_contact' label='Operations Manager' value='operations_manager'
                                +toggle_boolean_checkbox key='escalation_three_scondary_contact_franchisee' label='Franchisee'
                            .column
                                +view_sla_contact key='escalation_three_scondary_contact'
                                .ui.hidden.divider
                                if escalation_three_scondary_contact_franchisee
                                    p Franchisee will be contacted.
                                else
                                    p Franchisee will not be contacted.
        h3.ui.dividing.header Escalation 4
        .ui.two.column.divided.padded.grid
            .row
                +edit_number_field key='escalation_four_hours' label='Escalation Hours' field_class='inline' min=0 max=24
            .row
                .column
                    h4.ui.header Primary Contact
                    .ui.two.column.stackable.grid
                        .row
                            .column
                                .ui.form
                                    .grouped.fields
                                        // label Primary Contact
                                        +radio_item key='escalation_four_primary_contact' label='Office Owner' value='office_owner'
                                        +radio_item key='escalation_four_primary_contact' label='Operations Manager' value='operations_manager'
                                +toggle_boolean_checkbox key='escalation_four_primary_contact_franchisee' label='Franchisee'
                            .column
                                +view_sla_contact key='escalation_four_primary_contact'
                                .ui.hidden.divider
                                if escalation_four_primary_contact_franchisee
                                    p Franchisee will be contacted.
                                else
                                    p Franchisee will not be contacted.
                .column
                    h4.ui.header Secondary Contact
                    .ui.two.column.stackable.grid
                        .row
                            .column
                                .ui.form
                                    .grouped.fields
                                        // label Primary Contact
                                        +radio_item key='escalation_four_scondary_contact' label='Office Owner' value='office_owner'
                                        +radio_item key='escalation_four_scondary_contact' label='Operations Manager' value='operations_manager'
                                +toggle_boolean_checkbox key='escalation_four_scondary_contact_franchisee' label='Franchisee'
                            .column
                                +view_sla_contact key='escalation_four_scondary_contact'
                                .ui.hidden.divider
                                if escalation_four_scondary_contact_franchisee
                                    p Franchisee will be contacted.
                                else
                                    p Franchisee will not be contacted.
    .ui.bottom.attached.tab.segment(data-tab='franchisees')
        .ui.center.aligned.header #{current_office.ev.MASTER_LICENSEE}'s Franchisees
        +office_franchisees
    .ui.bottom.attached.tab.segment(data-tab='incidents')
        .ui.center.aligned.header #{current_office.ev.MASTER_LICENSEE}'s Incidents
        +office_incidents

    .ui.bottom.attached.tab.segment(data-tab='employees')
        .ui.center.aligned.header #{current_office.ev.MASTER_LICENSEE}'s Employees
        +office_employees
    .ui.bottom.attached.tab.segment(data-tab='customers')
        .ui.center.aligned.header #{current_office.ev.MASTER_LICENSEE}'s Customers
        +office_customers


template(name='office_customers')
    table.ui.basic.striped.table
        table.ui.celled.table
            thead
                tr
                    th Customer Name
                    th JPID
                    th Franchisee
                    // th Master Licensee
                    th Contact Person
                    th Contact Email
                    th Telephone
                    th Address
                    th
            tbody
                each office_customers
                    tr
                        td #{ev.CUST_NAME}
                        td #{ev.ID}
                        td #{ev.FRANCHISEE}
                        // td #{ev.MASTER_LICENSEE}
                        td #{ev.CUST_CONT_PERSON}
                        td #{ev.CUST_CONTACT_EMAIL}
                        td #{ev.TELEPHONE}
                        td #{ev.ADDR_STREET} #{ev.ADDR_CITY} #{ev.ADDR_STATE}
                        td 
                            +view_button

template(name='office_incidents')
    table.ui.basic.striped.table
        thead
            tr
                th Type
                th When
                // th Office
                th Details
                th Level
                th History
                th Actions
        tbody
            each office_incidents
                tr
                    td
                        +incident_type_label
                    td #{when}
                    // td #{incident_office_name}
                    td #{incident_details}
                    td #{current_level}
                    td
                        +small_doc_history
                    td 
                        +view_button


template(name='office_employees')
    table.ui.basic.striped.table
        thead
            tr
                th Username
                th First Name
                th Last Name
                th Title
                th Work Tel
                th Email
                // th Office Name
                th 
        tbody
            each office_employee_obs
                tr
                    td #{username}
                    td #{profile.first_name}
                    td #{profile.last_name}
                    td #{ev.JOB_TITLE}
                    td #{ev.WORK_TELEPHONE}
                    td #{email}
                    // td #{profile.office_name}
                    td 
                        +view_user_button


template(name='office_franchisees')
    table.ui.celled.table
        thead
            tr
                th JP ID
                th Name
                th Email
                th Short Name
                th Cell
                // th Office
                th
        tbody
            each office_franchisees_obs
                tr
                    td #{ev.ID}
                    td #{franchisee}
                    td #{ev.FRANCH_EMAIL}
                    td #{ev.FRANCH_NAME}
                    td #{ev.TELE_CELL}
                    // td #{ev.MASTER_LICENSEE}
                    td 
                        +view_button
