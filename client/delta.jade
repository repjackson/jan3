template(name='delta')
    .ui.stackable.padded.grid
        if currentUser
            unless delta
                .row
                    .sixteen.wide.column
                        if currentUser
                            .create_delta.ui.button(title='Create Session')
                                i.green.plus.icon
                                | Session
            if delta
                // .row
                //     .sixteen.wide.column
                //         .ui.breadcrumb
                //             a.section Home
                //             i.right.chevron.icon.divider
                //             a.section Registration
                //             i.right.arrow.icon.divider
                //             .active.section Personal Information
                .row
                    if delta.viewing_delta
                        unless delta.viewing_detail
                            .four.wide.column.scrolling
                                .ui.large.header
                                    if current_type.icon
                                        +icon name=current_type.icon classes='spaced mini'
                                    if current_type.plural
                                        | #{current_type.plural}
                                    else
                                        | #{current_type.title}
                                if can_add
                                    .ui.fluid.small.compact.button.add_doc
                                        i.plus.icon
                                        | #{current_type.title}

                                each delta_fields
                                    .ui.hidden.divider
                                    +facet
                    // unless delta.viewing_leftbar
                    //     unless delta.viewing_detail
                    //         unless delta.viewing_rightbar
                    //             unless delta.viewing_page
                    .center_column(class=center_column_class)
                        if delta.viewing_page
                            +Template.dynamic template=delta.page_template
                        else
                            +delta_results


template(name='toggle_delta_config')
    if boolean_true
        .ui.active.icon.compact.button.disable_key(title=label)
            +iconsmall name=icon
            // | #{label}
    else
        .ui.icon.compact.button.enable_key(title=label)
            +iconsmall name=icon
            // | #{label}



template(name='set_page_size')
    .one.wide.center.aligned.pointer.column.rounded.set_page_size(class=page_size_class title='Page Size')
        strong #{value}

template(name='set_delta_key')
    .ui.button.set_delta_key(class=set_delta_key_class)
        |#{label}

template(name='facet')
    // .ui.compact.segment
    .ui.accordion
        .active.title
            .ui.header
                if icon
                    i.icon
                        +iconsmall name=icon
                |#{title}
        .active.content
            // .ui.equal.width.grid.facet_class
            each values
                +selector

template(name='selector')
    if name
        // .column.toggle_value.pointer(class=toggle_value_class)
        .ui.compact.margined.toggle_value.button(class=toggle_value_class)
            .large110 #{name}
            // small #{count}
    else
        // .column.toggle_value.pointer(class=toggle_value_class)
        .ui.compact.margined.toggle_value.button(class=toggle_value_class)
            .large110 [none]
                small #{count}



template(name='delta_card')
    if delta.editing_mode
        .ui.center.aligned.large.header
            if detail_doc.icon
                i.large.icon
                    +icon name=detail_doc.icon
            else
                i.large.icon
                    +icon name='pencil'
            |Edit #{detail_doc.title} #{current_type.title}
    unless delta.editing_mode
        .ui.header
            if detail_doc.icon
                i.icon
                    +icon name=detail_doc.icon
            |#{detail_doc.title} Details
    .ui.card.delta_card(class=delta_card_class)
        with local_doc
            if doc_header_fields
                .content
                    .right.floated
                        if delta.editing_mode
                            .ui.green.large.icon.button.save
                                i.large.checkmark.icon
                            .ui.red.icon.basic.compact.button.remove_doc
                                i.remove.icon
                        else if full_mode
                            .ui.icon.button.edit
                                i.blue.pencil.icon
                    h4.ui.header
                        if icon
                            +icon name=icon
                        each doc_header_fields
                            |#{value}
                            |&nbsp;
            .content
                .ui.list
                    each field_docs
                        if value
                            .item
                                if field_template
                                    +Template.dynamic template=field_template
                                else
                                    .content
                                        if icon
                                            i.large.icon
                                                +icon name=icon
                                        | #{title}
                                        |&nbsp;
                                        if is_array
                                            each value
                                                .ui.basic.label #{this}
                                        else
                                            strong #{value}
            .content
                if delta.editing_mode
                    each edit_fields
                        +field_edit
                        // .ui.hidden.divider
                else
                    each fields
                        .field
                            +field_view
            unless delta.editing_mode
                each actions
                    .content
                        +Template.dynamic template=action_pane_template data=detail_doc
            if actions
                .content
                    each actions
                        +Template.dynamic template=action_button_template data=detail_doc

