template(name='office_header')
    with office_doc
        .ui.padded.stackable.grid
            .centered.middle.aligned.row
                .three.wide.center.aligned.column
                    if is_admin
                        +link_button link='/offices' icon='building' label='Offices'
                .ten.wide.column
                    h1.ui.center.aligned.header #{ev.MASTER_LICENSEE} Office
                .three.wide.right.aligned.column
                    // +edit_button
            .centered.row
                .sixteen.wide.center.aligned.column
                    .ui.horizontal.list
                        .item ##{ev.ID}
                        // .item Office Name
                        //     strong #{ev.MASTER_LICENSEE}
                        .item Owner
                            strong #{ev.MASTER_OFFICE_OWNER}
                        .item Manager
                            strong #{ev.MASTER_OFFICE_MANAGER}
                        // .item Last Updated
                        //     strong #{ev.TIMESTAMP}
                        .item #{ev.TELEPHONE}
                        .item 
                            |#{ev.ADDR_STREET} #{ev.ADDR_STREET_2} #{ev.ADDR_CITY} #{ev.ADDR_STATE} #{ev.ADDR_POSTAL_CODE} #{ev.MASTER_COUNTRY}
                            a(href=office_map_address target='_blank')
                                i.external.icon
            .centered.row
                .sixteen.wide.column
                    unless is_customer
                        +office_nav

template(name='office_nav')
    .ui.five.item.stackable.borderless.pointing.menu
        // a.item(href="/view/#{_id}" isActivePath="/view/#{_id}")
        //     i.big.icon
        //         +iconsmall name='link-company-parent'
        //     | &nbsp; #{ev.MASTER_LICENSEE}
        a.item(href="/office/#{_id}/incidents" class="{{ is_current_route 'office_incidents'}}")
            i.big.icon
                +iconsmall name='error'
            | &nbsp; Incidents
        a.item(href="/office/#{_id}/employees" class="{{ is_current_route 'office_employees'}}")
            i.big.icon
                +iconsmall name='groups'
            | &nbsp; Employees
        a.item(href="/office/#{_id}/franchisees" class="{{ is_current_route 'office_franchisees'}}")
            i.big.icon
                +iconsmall name='conference'
            | &nbsp; Franchisees
        a.item(href="/office/#{_id}/customers" class="{{ is_current_route 'office_customers'}}")
            i.big.icon
                +iconsmall name='customer-support'
            | &nbsp; Customers
        a.item(href="/office/#{_id}/settings" class="{{ is_current_route 'office_settings'}}")
            i.big.icon
                +iconsmall name='settings'
            | &nbsp; Settings


template(name='office_view')
    +office_header

template(name='office_customers')
    +office_header
    +query_input
    .ui.padded.grid
        .centered.row
            .sixteen.wide.column
                table.ui.celled.striped.sortable.fluid.table
                    thead
                        +sort_column_header key='ev.CUST_NAME' label='Customer Name'
                        +sort_column_header key='ev.ID' label='JPID'
                        +sort_column_header key='ev.FRANCHISEE' label='Franchisee'
                        +sort_column_header key='ev.CUST_CONT_PERSON' label='Contact Person'
                        +sort_column_header key='ev.CUST_CONTACT_EMAIL' label='Contact Email'
                        +sort_column_header key='ev.TELEPHONE' label='Telephone'
                        +sort_column_header key='ev.ADDR_STREET' label='Address'
                        +sort_column_header key='ev.TIMESTAMP' label='Timestamp'
                        th 
                    tbody
                        each office_customers
                            tr
                                td #{ev.CUST_NAME}
                                td #{ev.ID}
                                td #{ev.FRANCHISEE}
                                td #{ev.CUST_CONT_PERSON}
                                td #{ev.CUST_CONTACT_EMAIL}
                                td #{ev.TELEPHONE}
                                td #{ev.ADDR_STREET}
                                td #{ev.TIMESTAMP}
                                td 
                                    +view_button
                    +table_footer columns='8'                


template(name='office_incidents')
    +office_header
    +query_input
    .ui.padded.grid
        .centered.row
            .sixteen.wide.column
                table.ui.celled.striped.sortable.fluid.table
                    thead
                        +sort_column_header key='incident_number' label='Number'
                        +sort_column_header key='customer_name' label='Customer'
                        +sort_column_header key='timestamp' label='Logged'
                        +sort_column_header key='incident_type' label='Type'
                        +sort_column_header key='incident_details' label='Details'
                        +sort_column_header key='level' label='Level'
                        +sort_column_header key='submitted' label='Submitted'
                        th 
                    tbody
                        each office_incidents
                            tr
                                td #{incident_number}
                                td #{customer_name}
                                td {{reg_format timestamp}}
                                td 
                                    +incident_type_label
                                td #{incident_details}
                                td #{level}
                                td
                                    +submitted_template
                                td 
                                    +view_button
                    +table_footer columns='8'                



template(name='office_employees')
    +office_header
    +query_input
    .ui.padded.grid
        .centered.row
            .sixteen.wide.column
                table.ui.celled.striped.sortable.fluid.table
                    thead
                        +sort_column_header key='username' label='Username'
                        +sort_column_header key='profile.first_name' label='First Name'
                        +sort_column_header key='profile.last_name' label='Last Name'
                        +sort_column_header key='profile.title' label='Title'
                        +sort_column_header key='ev.WORK_TELEPHONE' label='Phone'
                        +sort_column_header key='email' label='Email'
                        +sort_column_header key='' label='Public'
                        th 
                    tbody
                        each office_employees
                            tr
                                td #{username}
                                td #{profile.first_name} #{profile.last_name}
                                td #{profile.title}
                                td #{ev.WORK_TELEPHONE}
                                td #{email}
                                td 
                                    +toggle_user_published
                                td 
                                    +edit_user_button
                                    +view_user_button
                    +table_footer columns='7'                


template(name='office_franchisees')
    +office_header
    +query_input
    .ui.padded.grid
        .centered.row
            .sixteen.wide.column
                table.ui.celled.striped.sortable.fluid.table
                    thead
                        +sort_column_header key='ev.ID' label='JPID'
                        +sort_column_header key='ev.FRANCHISEE' label='Name'
                        +sort_column_header key='ev.FRANCH_EMAIL' label='Email'
                        +sort_column_header key='ev.FRANCH_NAME' label='Short Name'
                        +sort_column_header key='ev.TELE_CELL' label='Phone'
                        th 
                    tbody
                        each office_franchisees
                            tr
                                td #{ev.ID}
                                td #{ev.FRANCHISEE}
                                td #{ev.FRANCH_EMAIL}
                                td #{ev.FRANCH_NAME}
                                td #{ev.TELE_CELL}
                                td 
                                    +view_button
                    +table_footer columns='7'                

                    
                    

template(name='office_settings')
    .ui.stackable.padded.grid
        .row
            +office_header
        .row
            .eight.wide.column
                +edit_textarea key='customer_message' label='Customer Dashboard Message'
                // +edit_text_field key='customer_special_services' label='Customer Dashboard Special Services'
            .eight.wide.column
                +edit_textarea key='customer_promotions' label='Customer Dashboard Promotions Message'
        .row
            .sixteen.wide.column
                h3.ui.header
                    +icon name='broom'
                    | &nbsp; Offered Services
                +office_service_settings
        .row
            .sixteen.wide.column
                .ui.secondary.segment
                    h3.ui.header
                        +icon name='administrative-tools'
                        | &nbsp; SLA Settings
                    h5.ui.header Select Incident Types
                    each incident_types
                        .select_incident_type.ui.small.compact.button(class=select_incident_type_button_class) #{name}
                    if selected_incident_type
                        each rule_docs
                            .ui.secondary.segment
                                h4.ui.header #{name} for #{selected_incident_type} Rules
                                .ui.equal.width.grid
                                    .column
                                        unless is_initial
                                            +edit_number_field key=hours_key label='Escalation Minutes' field_class='inline' min=0 max=24
                                            .ui.hidden.divider
                                        +toggle_boolean_checkbox key=franchisee_toggle_key label='Franchisee'
                                    .column
                                        // h4.ui.dividing.header Primary Contact
                                        +single_user_select key=primary_contact_key label="Primary Contact Employee Select"
                                    .column
                                        // h4.ui.dividing.header Secondary Contact
                                        +single_user_select key=secondary_contact_key label='Secondary Contact Employee Select'
            
template(name='office_service_settings')
    // h5.ui.header Select which to offer customers.
    each services
        .select_service.ui.button(class=select_service_button_class) #{title}