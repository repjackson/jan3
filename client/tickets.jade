template(name='tickets')
    .ui.padded.stackable.grid
        .row
            .four.wide.column
                .ui.large.header
                    +icon name='tasks'
                    | Tasks
                .ui.fluid.button
                    i.icon
                        +icon name='plus'
                    |Add Task
                .ui.hidden.divider
                unless session_doc
                    .ui.button.create_session
                        i.plus.icon
                        | Create Session
                else
                    if is_dev
                        .ui.icon.button.show_session
                            i.code.icon
                    .ui.button.delete_facet(title='Clear Session')
                        i.remove.icon
                        |Clear
                    .ui.button.run_fe(title='Refresh')
                        i.refresh.icon
                        |Reset


                // .ui.large.fluid.button.toggle_incomplete(class=incomplete_class)
                //     i.icon
                //         +icon name='unchecked-checkbox'
                //     |Incomplete
                // .ui.large.fluid.button.toggle_complete(class=complete_class)
                //     i.icon
                //         +icon name='checkmark'
                //     |Complete
                // .ui.large.fluid.button.toggle_by_me(class=by_me_class)
                //     i.icon
                //         +icon name='login-rounded-right'
                //     |Assigned by Me
                // .ui.large.fluid.button.toggle_to_me(class=to_me_class)
                //     i.icon
                //         +icon name='login-rounded'
                //     | Assigned to Me
                each faceted_fields
                    +facet


            .twelve.wide.column
                .ui.equal.width.stackable.grid
                    .column.scrolling
                        each session_doc.result_ids
                            +ticket_card
                    if viewing_task_id
                        .column
                            with viewing_task
                                .ui.fluid.card
                                    .content
                                        .right.floated
                                            if complete
                                                +icon name='checkmark'
                                            else
                                                +icon name='unchecked-checkbox'
                                        .header #{title}
                                        .meta #{when} by #{author_username}

                                    .content
                                        .description #{details}
                                    .content
                                        .ui.list
                                            .item
                                                .content
                                                    i.icon
                                                        +icon name='user-male'
                                                    |Assigned to
                                                    strong #{assigned_to}
                                            .item
                                                .content
                                                    i.icon
                                                        +icon name='user-shield'
                                                    |Assigned by
                                                    strong #{assigned_by}
                                            if due_date
                                                .item
                                                    .content
                                                        i.icon
                                                            +icon name='clock'
                                                        |Due Date
                                                        strong #{due_date}
                                            if tags
                                                .item
                                                    .content
                                                        i.icon
                                                            +icon name='tags'
                                                        each tags
                                                            .ui.basic.label #{this}
                                          .item ticket_number: #{ticket_number}
                                          .item franchisee_jpid: #{franchisee_jpid}
                                          .item office_jpid: #{office_jpid}
                                          .item customer_jpid: #{customer_jpid}
                                          .item customer_name: #{customer_name}
                                          .item ticket_office_name: #{ticket_office_name}
                                          .item ticket_franchisee: #{ticket_franchisee}
                                          .item level: #{level}
                                          .item open: #{open}
                                          .item submitted: #{submitted}
                                          .item timestamp: #{timestamp}
                                          .item updated: #{updated}
                                          .item long_timestamp: #{long_timestamp}
                                          .item ticket_type: #{ticket_type}
                                          .item ticket_details: #{ticket_details}
                                          .item service_date: #{service_date}
                                          .item submitted_datetime: #{submitted_datetime}
                                          .item last_updated_datetime: #{last_updated_datetime}
                                          .item assigned_to: #{assigned_to}


                                    .content
                                        .ui.button
                                            +icon name='pencil'

                                    .content
                                        if complete
                                            .ui.button.mark_incomplete
                                                +icon name='unchecked-checkbox'
                                        else
                                            .ui.button.mark_complete
                                                +icon name='checkmark'
                                        .ui.button
                                            +icon name='good-quality'
                                        .ui.button
                                            +icon name='poor-quality'
                                        .ui.button
                                            +icon name='add-user-male'
                                        .ui.button
                                            +icon name='chat'
                                        .ui.button
                                            +icon name='open-envelope'
                            .ui.fluid.button.close_pane
                                // |Viewing Task
                                i.right.chevron.icon

template(name='ticket_card')
    with local_doc
        .ui.fluid.link.card.ticket_card(class=ticket_card_class)
            .content
                .right.floated
                    if complete
                        +icon name='checkmark'
                    else
                        +icon name='unchecked-checkbox'
                .header #{title}
                .meta #{when} by #{author_username}
            .content
                .description #{details}
            .content
                .ui.list
                  .item ticket_number: #{ticket_number}
                  .item franchisee_jpid: #{franchisee_jpid}
                  .item office_jpid: #{office_jpid}
                  .item customer_jpid: #{customer_jpid}
                  .item customer_name: #{customer_name}
                  .item ticket_office_name: #{ticket_office_name}
                  .item ticket_franchisee: #{ticket_franchisee}
                  .item level: #{level}
                  .item open: #{open}
                  .item submitted: #{submitted}
                  .item timestamp: #{timestamp}
                  .item updated: #{updated}
                  .item long_timestamp: #{long_timestamp}
                  .item ticket_type: #{ticket_type}
                  .item ticket_details: #{ticket_details}
                  .item service_date: #{service_date}
                  .item submitted_datetime: #{submitted_datetime}
                  .item last_updated_datetime: #{last_updated_datetime}
                  .item assigned_to: #{assigned_to}


template(name='facet')
    .ui.header
        if icon
            i.icon
                +iconsmall name=icon
        |#{title}
    each values
        +select


template(name='select')
    .ui.toggle_value.button(class=toggle_value_class)
        |#{name}
        small #{count}
