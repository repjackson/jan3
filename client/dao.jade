template(name='dao')
    .ui.stackable.grid
        .row
            unless facet_doc
                .sixteen.wide.column
                    .ui.secondary.segment
                        .ui.small.header Sessions
                        if currentUser
                            .create_facet.ui.icon.button(title='Create Session')
                                i.plus.icon
                        each my_facets
                            a.ui.button(href="/p/dao?doc_id=#{_id}")
                                |#{title}
                                i.right.arrow.icon
            else
                .right.floated.three.wide.column
                    .set_view_cards.ui.button(class=view_cards_class)
                        +iconsmall name='activity-grid-2'
                    .set_view_segments.ui.button(class=view_segments_class)
                        +iconsmall name='menu'
                    .set_view_table.ui.button(class=view_table_class)
                        +iconsmall name='data-sheet-filled'
        .row
            if facet_doc
                .four.wide.column
                    if currentUser
                        if is_editing
                            .ui.icon.input
                                input.facet_title(type='text' placeholder='Edit Title' value=facet_doc.title)
                                i.stop_editing.checkmark.link.icon
                        else
                            .ui.header
                                |#{facet_doc.title}
                            i.start_editing.link.pencil.icon
                    each filters
                        +filter
                    if editing_mode
                        #add_filter.ui.button
                            i.plus.icon
                            | Filter
                        .ui.list
                            each facet_doc.args
                                .item
                                    |#{key}: #{value}
                                    i.remove_arg.remove.link.icon
                .twelve.wide.column
                    if view_segments
                        each facet_doc.results
                            +facet_segment
                    if view_table
                        +facet_table
                    if view_cards
                        .ui.four.stackable.cards
                            each facet_doc.results
                                +facet_card


template(name='set_facet_key')
    .ui.button.small.compact.set_facet_key(class=set_facet_key_class)
        |#{label}


template(name='filter')
    .ui.secondary.segment
        .ui.small.header
            if icon
                +icon name=icon
            |#{label}
        if editing_mode
            |key: #{key}
        each values
            .ui.small.compact.toggle_value.button(class=toggle_value_class)
                |#{value} #{count}
        if editing_mode
            // i.recalc.link.refresh.icon
            +edit_filter_field key='label' filter_id=this._id
            +edit_filter_field key='key' filter_id=this._id
            +edit_filter_field key='icon' filter_id=this._id


template(name='edit_filter_field')
    .ui.labeled.fluid.input
        .ui.basic.label #{key}
        input.text_val(type='text')

