template(name='services')
    .ui.stackable.centered.padded.grid
        .middle.aligned.row
            .three.wide.column
                if is_admin
                    +link_button link='/p/admin' icon='user-shield' label='Admin'
            .ten.wide.column
                h1.ui.center.aligned.header
                    +icon name='housekeeping'
                    | Services
            .three.wide.right.aligned.column
                +add_button type='service'
        .row
            .four.wide.column
                .ui.secondary.segment
                    .ui.header
                        +icon name='leaderboard'
                        | Most Popular
                    .ui.list
                        each top_requested
                            .item 
                                if image_id
                                    img.ui.avatar.image(src="{{c.url image_id height=100 width=100 crop='scale'}}")
                                if icon
                                    +icon name=icon
                                |#{title} #{request_count}
                .ui.secondary.segment
                    .ui.header
                        +icon name='headset'
                        | Most Requesting Customer
                .ui.secondary.segment
                    .ui.header
                        +icon name='business'
                        | Most Requested Franchisee
                .ui.secondary.segment
                    .ui.header
                        +icon name='building'
                        | Most Requested Office
            .twelve.wide.column
                .ui.centered.three.cards
                    each services
                        +service_card
                
template(name='service_card')
    .ui.card
        .content
            a.header(href="/v/#{_id}") 
                if image_id
                    img.ui.avatar.image(src="{{c.url image_id height=100 width=100 crop='scale'}}")
                    // .right.floated.meta $#{price}
                if icon
                    +icon name=icon
                |#{title}
            if is_admin
                .meta #{slug}
            .description
                p #{description}
        if request_count
            .content
                | #{request_count} requests
        .content
            +request_service_button
            a.ui.button(href="/v/#{_id}") 
                i.large.icon
                    +iconsmall name='view-details'
                |Details
    
template(name='service_item')
    .item
        if image_id
            a.image(href="/v/#{_id}")
                img.ui.tiny.image(src="{{c.url image_id height=200 width=200 crop='scale'}}")
        .content
            // .right.floated.meta $#{price}
            a.header(href="/v/#{_id}") #{title}
            if is_admin
                .meta #{slug}
            .description
                p #{description}
        // if request_count
        //     .content
        //         | #{request_count} requests
        .content
            +request_service_button
            a.ui.button(href="/v/#{_id}") 
                i.large.icon
                    +iconsmall name='view-details'
                |Details
    
template(name='request_service_button')                    
    .request_service.ui.button 
        i.large.icon
            +iconsmall name='service-bell'
        | Request 
                    
template(name='service_view')
    .ui.padded.stackable.grid
        .centered.middle.aligned.row
            .three.wide.column
                +link_button link='/services' icon='building' label='Services'
            .ten.wide.column
                h1.ui.center.aligned.grey.header 
                    if icon
                        +icon name=icon
                    |'#{title}' Service
            .three.wide.right.aligned.column
                +edit_button
        .centered.row
            .four.wide.column
                // .ui.header Price: $#{price}
                +request_service_button
                if is_admin
                    .ui.header Slug: #{slug}
            .twelve.wide.column
                .ui.secondary.segment
                    .large130 #{description}
                    img.ui.image.item(src="{{c.url image_id width=200 height=200 gravity='face' crop='fill'}}")
                +service_child_requests
                +full_doc_history
                
                
template(name='service_child_requests')
    .ui.secondary.segment
        .ui.header 
            +icon name='service-bell'
            |Requests
        each child_requests
            .ui.secondary.segment
                .content
                    .meta.right.floated 
                        +author_info
                    .header #{service_title}
                    .meta #{service_date}
                .content
                    .meta Requested #{when}
                    .large130 #{request_details}
                .content
                    +view_button
            .ui.hidden.divider
                        
template(name='service_edit')
    .ui.padded.stackable.centered.grid
        .centered.row
            .three.wide.center.aligned.column
                #delete.ui.icon.button
                    i.trash.icon
            .ten.wide.column
                h1.ui.center.aligned.grey.header Edit '#{title}' Service
            .three.wide.center.aligned.column
                +save_button
        .centered.row
            .ten.wide.column
                .ui.form
                    +edit_text_field key='title' label='Title'
                    +edit_text_field key='icon' label='Icon'
                    if icon
                        +icon name=icon
                    +edit_text_field key='slug' label='Slug' icon='code'
                    // +edit_number_field key='price' label='Price' icon='money'
                    +edit_image_field
                    +edit_textarea key='description' label='Description' icon='details'
                    
                    
template(name='service_request_view')
    .ui.padded.stackable.grid
        .centered.middle.aligned.row
            .three.wide.center.aligned.column
                +link_button link='/services' icon='building' label='Services'
            .ten.wide.column
                h1.ui.center.aligned.grey.header Service Request for #{service_title}
            .three.wide.center.aligned.column
                +edit_button
        .row
            .sixteen.wide.column
                .ui.secondary.segment
                    .ui.header Date: #{request_date}
                    .ui.header Details: #{request_details}
        .centered.row
            .twelve.wide.column
                +full_doc_history
                    
template(name='service_request_edit')
    .ui.padded.stackable.centered.grid
        .centered.row
            .three.wide.center.aligned.column
                #delete.ui.icon.button
                    i.trash.icon
            .ten.wide.column
                h1.ui.center.aligned.header Service Request for #{service_title}
            .three.wide.center.aligned.column
                if submitted
                    .ui.disabled.button Submitted #{submit_date}
                    +save_button
                else
                    if can_submit
                        #submit_request.ui.button Submit
                    else
                        .ui.disabled.button Can't Submit
        .centered.row
            .ten.wide.column
                .ui.form
                    +edit_date_field key='request_date' label='Request Date' icon='calendar'
                    +edit_textarea key='request_details' label='Request Details' icon='details'
                    
                    