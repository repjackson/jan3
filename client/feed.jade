template(name='event_view')
    .ui.padded.stackable.grid
        .centered.row
            .three.wide.center.aligned.column
                +link_button link='/p/feed' label='Feed' icon='rss'
            .ten.wide.column
                h1.ui.header
                    +iconlarge name='rss'
                    | Event View
        .centered.row
            .ten.wide.column
                .event
                    .label
                        img.ui.avatar.image(src="{{c.url author.image_id width=100 height=100 gravity='face' crop='fill'}}")
                    .content
                        .summary
                            a.user #{author.username}
                            |#{action} #{text}
                            a(href="/v/#{parent._id}") #{parent.title}
                            .date #{when}
                        .meta
                            +mark_read_link
                            if is_dev
                                i.remove_event.remove.link.icon


template(name='users_feed')
    h1.ui.header
        +icon name='rss'
        | Users Feed
    .ui.feed
        each feed_events
            +event


template(name='full_doc_history')
    .ui.feed
        each doc_history_events
            +event

template(name='event')
    .event
        .label
            // img.ui.avatar.image(src="{{c.url author.profile.image_id width=100 height=100 gravity='face' crop='fill'}}")
            if is_escalation
                +level_icon
            else if event_type_doc.icon
                +icon name=event_type_doc.icon
            else
                +icon name='commit-git'
        .content
            .summary #{action} #{text}
            .meta
                span(title="{{ long_format timestamp }}") #{when}
                if editing_mode
                    span(title='Event Type') #{event_type}
                    span #{parent_id}
                if author_id
                    i.user.icon(title='Author')
                    a.user(href="/p/user_view?username=#{author.username}") #{author.username}
                if customer_jpid
                    a(href="/p/customer?jpid=#{customer_jpid}")
                        i.money.icon(title="Customer #{customer_jpid}")
                        |#{parent.customer_name}
                if office_jpid
                    i.building.icon(title="Office #{office_jpid}")
                    a(href="/p/office?jpid=#{office_jpid}")
                        |#{parent.ticket_office_name}
                if editing_mode
                    i.remove_event.remove.link.icon
                a(href="/p/ticket_admin_view?doc_id=#{parent_id}")
                    i.ticket.icon
                    |Ticket ##{parent.ticket_number}


template(name='small_doc_history')
    // .ui.header History
    .ui.feed
        each doc_history_events
            +small_history_event

template(name='small_history_event')
    .event
        .content
            .extra.text
                |#{action} #{text}
            .summary
                .date {{long_format timestamp}}





template(name='global_feed')
    .ui.feed.scrolling_small
        each feed_events
            +event


template(name='doc_history_event')
    .comment
        .avatar
            // img.ui.avatar.image(src="{{c.url author.profile.image_id width=100 height=100 gravity='face' crop='fill'}}")
            +icon name=event_type_doc.icon
        .content
            if show_author
                a.user #{author.username}
            .metadata
                .date {{ reg_format timestamp }}
                .rating(title='Event Type') #{event_type}
                i.building.icon(title='Office')
                i.money.icon(title='Customer')
                i.user.icon(title='Author')
            .text #{action} #{text}
            .actions
                if is_dev
                    i.remove_event.remove.link.icon

